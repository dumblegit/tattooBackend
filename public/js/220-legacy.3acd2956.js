"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[220],{9220:function(a,t,e){e.r(t),e.d(t,{default:function(){return c}});var o=function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",{staticClass:"d-flex flex-column align-items-center"},[e("br"),e("h1",{staticClass:"my-5"},[a._v("Edici√≥n de usuario üõ†")]),e("form",{staticClass:"d-flex flex-column",attrs:{enctype:"multipart/form-data"},on:{submit:function(t){return t.preventDefault(),a.actualizarUsuario(a.usuario)}}},[e("div",{staticClass:"container px-5 pb-3",attrs:{id:"form"}},[e("h3",{staticClass:"mt-3"},[a._v("Usuario")]),e("input",{directives:[{name:"model",rawName:"v-model",value:a.usuario.nombre,expression:"usuario.nombre"}],staticClass:"form-control my-2",attrs:{type:"text",placeholder:"Nombre",required:""},domProps:{value:a.usuario.nombre},on:{input:function(t){t.target.composing||a.$set(a.usuario,"nombre",t.target.value)}}}),a.usuario.admin?e("div",{staticClass:"d-flex justify-content-center mt-3"},[e("p",[a._v("Tipo de usuario:")]),e("div",{staticClass:"form-check mx-5"},[e("input",{directives:[{name:"model",rawName:"v-model",value:a.usuario.tatuador,expression:"usuario.tatuador"}],staticClass:"form-check-input",attrs:{type:"radio",name:"flexRadioDefault",id:"tatuador",value:"true",required:""},domProps:{checked:a._q(a.usuario.tatuador,"true")},on:{change:function(t){return a.$set(a.usuario,"tatuador","true")}}}),e("label",{staticClass:"form-check-label",attrs:{for:"tatuador"}},[a._v("Tatuador")])]),e("div",{staticClass:"form-check"},[e("input",{directives:[{name:"model",rawName:"v-model",value:a.usuario.tatuador,expression:"usuario.tatuador"}],staticClass:"form-check-input",attrs:{type:"radio",name:"flexRadioDefault",id:"cliente",value:"false",checked:"",required:""},domProps:{checked:a._q(a.usuario.tatuador,"false")},on:{change:function(t){return a.$set(a.usuario,"tatuador","false")}}}),e("label",{staticClass:"form-check-label",attrs:{for:"cliente"}},[a._v("Cliente")])])]):a._e(),e("div",{staticClass:"d-flex"},[e("label",{attrs:{for:"date"}},[a._v("Fecha de nacimiento:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:a.usuario.fechaNacimiento,expression:"usuario.fechaNacimiento"}],staticClass:"form-control my-2",attrs:{type:"date",id:"date",required:""},domProps:{value:a.usuario.fechaNacimiento},on:{input:function(t){t.target.composing||a.$set(a.usuario,"fechaNacimiento",t.target.value)}}})]),e("div",{staticClass:"d-flex align-items-center"},[a._v(" Foto de perfil: "),e("input",{staticClass:"form-control m-2",attrs:{type:"file"},on:{change:a.agregarFile}})]),e("div",{staticClass:"input-group mb-2"},[a._m(0),e("input",{directives:[{name:"model",rawName:"v-model",value:a.usuario.usuario,expression:"usuario.usuario"}],staticClass:"form-control my-2",attrs:{type:"text",id:"inlineFormInputGroup",placeholder:"Username",required:""},domProps:{value:a.usuario.usuario},on:{input:function(t){t.target.composing||a.$set(a.usuario,"usuario",t.target.value)}}})]),e("div",[e("b-form",{on:{submit:function(a){a.stopPropagation(),a.preventDefault()}}},[a.accion?e("b-form-input",{attrs:{type:"password",placeholder:"Contrase√±a",id:"feedback-user"},model:{value:a.usuario.password,callback:function(t){a.$set(a.usuario,"password",t)},expression:"usuario.password"}}):e("b-form-input",{attrs:{type:"password",placeholder:"Contrase√±a",state:a.validation,id:"feedback-user"},model:{value:a.usuario.password,callback:function(t){a.$set(a.usuario,"password",t)},expression:"usuario.password"}}),a.accion?a._e():e("b-form-invalid-feedback",{attrs:{state:a.validation}},[a._v(" Debe tener entre 8 y 16 caracteres, al menos un d√≠gito, al menos una min√∫scula y al menos una may√∫scula. ")]),a.accion?a._e():e("b-form-valid-feedback",{attrs:{state:a.validation}},[a._v(" ok. ")])],1)],1)]),e("b-button",{staticClass:"my-4",attrs:{id:"enviar",pill:"",type:"submit"}},[a._v("Editar")])],1),e("div",{staticClass:"container"},[e("b-alert",{attrs:{show:a.dismissCountDown,variant:a.mensaje.color},on:{dismissed:function(t){a.dismissCountDown=0},"dismiss-count-down":a.countDownChanged}},[e("p",[a._v(a._s(a.mensaje.texto))]),e("b-progress",{attrs:{variant:a.mensaje.color,max:a.dismissSecs,value:a.dismissCountDown,height:"4px"}})],1)],1)])},i=[function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",{staticClass:"input-group-prepend"},[e("span",{staticClass:"input-group-text my-2",attrs:{id:"apend"}},[a._v("@")])])}],s=(e(4916),e(3123),e(7601),e(1539),e(6699),{data:function(){return{usuarios:[],dismissSecs:5,dismissCountDown:0,showDismissibleAlert:!1,mensaje:{color:"",texto:""},usuario:{nombre:"",tatuador:Boolean,fechaNacimiento:"",fotoPerfil:"",usuario:"",password:"",aboutYou:"",archivo:null,acceso:!1,admin:!1},nickname:"",accion:!1,valida:""}},created:function(){var a=this;"true"==localStorage.getItem("tatuador")&&(this.accion=!0);var t=location.href.split("?id=")[1];if(void 0==t||"true"!=localStorage.getItem("tatuador")&&t!=localStorage.getItem("id"))this.$router.go(-1);else{"true"==localStorage.getItem("tatuador")&&(this.usuario.acceso=!0,this.usuario.admin=!0);var e=location.href.split("?id=")[1];this.axios.get("usuarios/listar/"+e).then((function(t){a.usuario=t.data,a.nickname=t.data.usuario,a.usuario.fechaNacimiento=t.data.fechaNacimiento.substring(0,10)})).catch((function(a){console.log(a.response)}))}},computed:{validation:function(){var a=/^(?=\w*\d)(?=\w*[A-Z])(?=\w*[a-z])\S{8,16}$/;return a.test(this.usuario.password)?this.valida=!0:this.valida=!1,a.test(this.usuario.password)}},methods:{alertaArchivoNulo:function(){this.mensaje.color="warning",this.mensaje.texto="La foto debe ser en formato .jpg .png o .jpeg",this.showAlert()},alertaTrue:function(){this.mensaje.color="primary",this.mensaje.texto="Usuario editado con exito! üëå",this.showAlert()},alertaFalse:function(){this.mensaje.color="warning",this.mensaje.texto="Error :(",this.showAlert()},alertaUsuarioExistente:function(){alert("Nombre de usuario ya existente")},actualizarUsuario:function(a){var t=this;1==this.valida&&0==this.accion||1==this.accion?this.axios.post("/usuarios/comprobarUsuario",this.usuario).then((function(e){0==e.data.existe||t.nickname==a.usuario?void 0!=t.usuario.archivo?t.axios.put("usuarios/eliminarFoto/"+a._id,a).then((function(a){})).catch((function(a){t.alertaFalse()})).finally((function(e){var o=new FormData;o.append("fotoPerfil",t.usuario.archivo),t.axios.post("/usuarios/agregarFoto",o).then((function(a){t.usuario.fotoPerfil=a.data})).catch((function(a){t.alertaFalse()})).finally((function(e){t.axios.put("usuarios/actualizar/"+a._id,a).then((function(a){t.usuario.nombre=a.data.nombre,t.usuario.tatuador=a.data.tatuador,t.usuario.fechaNacimiento=a.data.fechaNacimiento,t.usuario.usuario=a.data.usuario,t.usuario.password=a.data.password,t.usuario.aboutYou=a.data.aboutYou,t.usuario.fotoPerfil=a.data,t.alertaTrue()})).catch((function(a){t.alertaFalse()}))}))})):t.axios.put("usuarios/actualizar/"+a._id,a).then((function(a){1==t.valida&&0==t.accion||1==t.accion?(t.usuario.nombre=a.data.nombre,t.usuario.tatuador=a.data.tatuador,t.usuario.fechaNacimiento=a.data.fechaNacimiento,t.usuario.usuario=a.data.usuario,t.usuario.password=a.data.password,t.usuario.aboutYou=a.data.aboutYou,t.alertaTrue()):t.alertaFalse()})).catch((function(a){console.log(a)})):t.alertaUsuarioExistente()})):this.alertaFalse()},agregarFile:function(a){var t=a.target.files[0],e=["image/jpg","image/jpeg","image/png"];e.includes(t.type)?this.usuario.archivo=t:(this.alertaArchivoNulo(),a.target.value="")},countDownChanged:function(a){var t=this;this.dismissCountDown=a,"primary"==this.mensaje.color&&setTimeout((function(){t.$router.go(-1)}),5e3)},showAlert:function(){this.dismissCountDown=this.dismissSecs}}}),r=s,u=e(1001),n=(0,u.Z)(r,o,i,!1,null,null,null),c=n.exports}}]);
//# sourceMappingURL=220-legacy.3acd2956.js.map